(this["webpackJsonphuman-music"]=this["webpackJsonphuman-music"]||[]).push([[0],{69:function(t,e){},74:function(t,e,i){},84:function(t,e,i){},85:function(t,e,i){},86:function(t,e,i){"use strict";i.r(e);var a=i(36),s=i.n(a),n=i(2),r=i.n(n),o=i(3),u=i(4),h=i(6),l=i.n(h),c=i(1),d=i(0),f=function(){function t(e,i,a,s,n,r){Object(d.a)(this,t),this.states=void 0,this.size=void 0,this.radius=void 0,this.rule=void 0,this._state=void 0,this.tempState=void 0,this.neighbourhoodCode=void 0,this.lookupTable=void 0,this.states=e,this.size=i,this.radius=a,this.rule=s,this._state=n,this.lookupTable=r,this.tempState=Array.from({length:i}),this.neighbourhoodCode=Array.from({length:i})}return Object(c.a)(t,[{key:"state",get:function(){return this._state}},{key:"evolve",value:function(){var t=this;this.state.forEach((function(e,i){t.evolveCellAt(i)}));var e=this.tempState;this.tempState=this._state,this._state=e}},{key:"evolveCellAt",value:function(t){var e=this.lookupTable.length-this.computeCodeFor(t)-1;this.tempState[t]=e>=0?this.lookupTable[e]:0}},{key:"computeCodeFor",value:function(t){var e,i=Math.pow(this.states,2*this.radius),a=0;if(0===t)for(var s=-this.radius;s<=this.radius;s++)e=this.wrappedIndex(s),a+=i*this._state[e],i/=this.states;else{e=this.wrappedIndex(t-this.radius-1);var n=i*this._state[e];e=this.wrappedIndex(t+this.radius);var r=this._state[e];a=(this.neighbourhoodCode[t-1]-n)*this.states+r}return this.neighbourhoodCode[t]=a,a}},{key:"wrappedIndex",value:function(t){return t<0?t+this.size:t>=this.size?t-this.size:t}}]),t}();f.Builder=function(){function t(){Object(d.a)(this,t),this.states=2,this.size=100,this.rule=0,this.randomInitialConfiguration=!1}return Object(c.a)(t,[{key:"withStates",value:function(t){if(t<1)throw new Error("Number of states must be greater than 1");return this.states=t,this}},{key:"withSize",value:function(t){if(this.size=t,t<=10)throw new Error("Size of cellular automata must be greater than 10");return this}},{key:"withRule",value:function(t){if(this.rule=t,t<0)throw new Error("Rule must be a positive number");return this}},{key:"withRandomInitialConfiguration",value:function(){return this.randomInitialConfiguration=!0,this}},{key:"build",value:function(){for(var t=this,e=Array.from(BigInt(this.rule).toString(this.states)),i=Array.from({length:e.length}),a=0;a<e.length;a++){var s=e[a];i[a]=s>="0"&&s<="9"?+e[a]-0:+e[a]-NaN}var n=this.randomInitialConfiguration?Array.from({length:this.size},(function(){return Math.round(Math.random())})):Array.from({length:this.size},(function(e,i){return i===Math.floor(t.size/2)?1:0}));return new f(this.states,this.size,1,this.rule,n,i)}}]),t}();var m,v,p=function(){function t(e,i,a,s,n,r){Object(d.a)(this,t),this.states=void 0,this.size=void 0,this.radius=void 0,this.rule=void 0,this._state=void 0,this.tempState=void 0,this.neighbourhoodCode=void 0,this.lookupTable=void 0,this.states=e,this.size=i,this.radius=a,this.rule=s,this._state=n,this.lookupTable=r,this.tempState=Array.from({length:i}),this.neighbourhoodCode=Array.from({length:i})}return Object(c.a)(t,[{key:"state",get:function(){return this._state}},{key:"evolve",value:function(){var t=this;this.state.forEach((function(e,i){t.evolveCellAt(i)}));var e=this.tempState;this.tempState=this._state,this._state=e}},{key:"evolveCellAt",value:function(t){var e=this.lookupTable.length-this.computeCodeFor(t)-1;this.tempState[t]=e>=0?this.lookupTable[e]:0}},{key:"computeCodeFor",value:function(t){var e,i=2*this.radius+1,a=0;if(0===t)for(var s=-this.radius;s<i;s++)e=this.wrappedIndex(s),a+=this._state[e];else{e=this.wrappedIndex(t-this.radius-1);var n=this._state[e];e=this.wrappedIndex(t+this.radius);var r=this._state[e];a=this.neighbourhoodCode[t-1]-n+r}return this.neighbourhoodCode[t]=a,a}},{key:"wrappedIndex",value:function(t){return t<0?t+this.size:t>=this.size?t-this.size:t}}]),t}();!function(t){t[t.UNIDIMENSIONAL=0]="UNIDIMENSIONAL",t[t.BIDIMENSIONAL=1]="BIDIMENSIONAL"}(m||(m={})),function(t){t[t.TOTALISTIC=0]="TOTALISTIC",t[t.ELEMENTARY=1]="ELEMENTARY"}(v||(v={}));var b=function t(){Object(d.a)(this,t)};b.Builder=function(){function t(){Object(d.a)(this,t),this.dimensions=m.UNIDIMENSIONAL,this.type=v.ELEMENTARY,this.states=2,this.size=100,this.rule=0,this.randomInitialConfiguration=!1}return Object(c.a)(t,[{key:"withDimensions",value:function(t){if(t===m.BIDIMENSIONAL)throw new Error("Bi-dimensional automata not implemented yet");return this.dimensions=t,this}},{key:"withType",value:function(t){return this.type=t,this}},{key:"withStates",value:function(t){if(t<1)throw new Error("Number of states must be greater than 1");return this.states=t,this}},{key:"withSize",value:function(t){if(this.size=t,t<=10)throw new Error("Size of cellular automata must be greater than 10");return this}},{key:"withRule",value:function(t){if(this.rule=t,t<0)throw new Error("Rule must be a positive number");return this}},{key:"withRandomInitialConfiguration",value:function(){return this.randomInitialConfiguration=!0,this}},{key:"build",value:function(){return this.type===v.TOTALISTIC?this.buildTotallistic1D():this.buildElementary1D()}},{key:"buildTotallistic1D",value:function(){for(var t=this,e=Array.from(BigInt(this.rule).toString(this.states)),i=Array.from({length:e.length}),a=0;a<e.length;a++)i[a]=+e[a]-0;var s=this.randomInitialConfiguration?Array.from({length:this.size},(function(){return Math.round(Math.random())})):Array.from({length:this.size},(function(e,i){return i===Math.floor(t.size/2)?1:0}));return new p(this.states,this.size,1,this.rule,s,i)}},{key:"buildElementary1D",value:function(){for(var t=this,e=Array.from(BigInt(this.rule).toString(this.states)),i=Array.from({length:e.length}),a=0;a<e.length;a++){var s=e[a];i[a]=s>="0"&&s<="9"?+e[a]-0:+e[a]-NaN}var n=this.randomInitialConfiguration?Array.from({length:this.size},(function(){return Math.round(Math.random())})):Array.from({length:this.size},(function(e,i){return i===Math.floor(t.size/2)?1:0}));return new f(this.states,this.size,1,this.rule,n,i)}}]),t}();var w=(new b.Builder).withDimensions(m.UNIDIMENSIONAL).withType(v.ELEMENTARY).withSize(301).withRule(0).withStates(2).build(),y=l.a.createContext(w),g=i(37),k=(i(74),["#000000","#e8b354","#568140"]),j=function(){function t(e,i){Object(d.a)(this,t),this.step=0,this.cellSize=void 0,this.sketch=void 0,this.automata=void 0,this.sketch=e,this.automata=i,this.cellSize=Math.ceil(e.width/i.size)}return Object(c.a)(t,[{key:"updateAutomata",value:function(t){this.automata=t,this.step=0}},{key:"draw",value:function(){for(var t=0;t<this.automata.size;t++)this.sketch.noStroke(),this.sketch.fill(k[this.automata.state[t]]),this.sketch.rect(this.cellSize*t,this.step*this.cellSize,this.cellSize,this.cellSize);this.step++}}]),t}();j.Builder=function(){function t(){Object(d.a)(this,t),this.sketch=void 0,this.automata=void 0}return Object(c.a)(t,[{key:"withSketch",value:function(t){return this.sketch=t,this}},{key:"withAutomata",value:function(t){return this.automata=t,this}},{key:"build",value:function(){if(null===this.automata)throw new Error("Must pass a cellular automata upon building");if(null===this.sketch)throw new Error("Must pass a p5 sketch upon building");return new j(this.sketch,this.automata)}}]),t}();var O=i(11),A=function(){function t(e,i){Object(d.a)(this,t),this.note="R",this.lastNote="R",this.notes=["R","B2","C3","D3","E3","F3","G3","A3","B3","C4"],this.instrument=void 0,this.automata=void 0,this.instrument=e,this.automata=i}return Object(c.a)(t,[{key:"updateAutomata",value:function(t){this.automata=t,this.instrument.triggerRelease(this.lastNote),this.note="R",this.lastNote="R"}},{key:"play",value:function(){var t=this.automata.state.filter((function(t){return 0!==t})).length;this.note=this.notes[t%this.notes.length],this.note!==this.lastNote&&(this.instrument.triggerRelease(this.lastNote,O.c()),"R"!==this.note&&this.instrument.triggerAttack(this.note,O.c())),this.lastNote=this.note}}]),t}();A.Builder=function(){function t(){Object(d.a)(this,t),this.automata=void 0}return Object(c.a)(t,[{key:"withAutomata",value:function(t){return this.automata=t,this}},{key:"build",value:function(){var t=Object(o.a)(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==this.automata){t.next=2;break}throw new Error("Must pass a cellular automata upon building");case 2:return e=new O.a({urls:{A1:"A1.mp3",A2:"A2.mp3"},baseUrl:"https://tonejs.github.io/audio/casio/"}).toDestination(),t.next=5,O.b();case 5:return t.abrupt("return",new A(e,this.automata));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}();var I,N,S,E=i(5);function z(){return(z=Object(o.a)(r.a.mark((function t(e){var i,a,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=w,a=(new j.Builder).withSketch(e).withAutomata(i).build(),t.next=4,(new A.Builder).withAutomata(i).build();case 4:return s=t.sent,t.abrupt("return",{initialAutomata:i,painter:a,player:s});case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var C=function(t){var e=!1,i=document.getElementById("sketch"),a=i?i.clientWidth:0,s=i?i.clientHeight:0;t.setup=function(){t.createCanvas(a,s),t.frameRate(5),function(t){return z.apply(this,arguments)}(t).then((function(t){var i=t.initialAutomata,a=t.painter,s=t.player;I=i,N=a,S=s,e=!0}))},t.updateWithProps=function(i){var a,s;i.automata&&e&&(I=i.automata,null===(a=N)||void 0===a||a.updateAutomata(I),null===(s=S)||void 0===s||s.updateAutomata(I),t.clear());t.draw=function(){var t,e,i;null===(t=N)||void 0===t||t.draw(),null===(e=S)||void 0===e||e.play(),null===(i=I)||void 0===i||i.evolve()}}};function x(){return Object(E.jsx)(y.Consumer,{children:function(t){return Object(E.jsx)("div",{className:"CellularAutomataSketch",id:"sketch",children:Object(E.jsx)(g.a,{customClass:"canvas",sketch:C,automata:t})})}})}i(84);function M(){var t=Object(h.useState)(!1),e=Object(u.a)(t,2),i=e[0],a=e[1],s=Object(h.useState)(0),n=Object(u.a)(s,2),l=n[0],c=n[1],d=Object(h.useState)(w),f=Object(u.a)(d,2),p=f[0],g=f[1];function k(){return(k=Object(o.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.d();case 2:a(!0),j();case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function j(){return A.apply(this,arguments)}function A(){return A=Object(o.a)(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=Math.round(255*Math.random()),c(e),g((new b.Builder).withDimensions(m.UNIDIMENSIONAL).withType(v.ELEMENTARY).withStates(2).withSize(301).withRule(e).build());case 3:case"end":return t.stop()}}),t)}))),A.apply(this,arguments)}return Object(E.jsx)(y.Provider,{value:p,children:Object(E.jsxs)("div",{className:"Euterpe",children:[Object(E.jsx)(x,{}),Object(E.jsxs)("div",{className:"Panel",children:[Object(E.jsxs)("div",{className:"Headers",children:[Object(E.jsx)("img",{src:"/human-music/earth.png",className:"EarthRadioLogo",alt:"Earth"}),Object(E.jsx)("h1",{className:"Title",children:"Human Music"}),Object(E.jsx)("h2",{className:"Subtitle",children:"by Earth Radio"})]}),Object(E.jsxs)("div",{className:"Controllers",children:[Object(E.jsx)("p",{className:"PlayingRule",children:i?"Playing rule: "+l:"--"}),i?Object(E.jsx)("button",{className:"ruleButton",onClick:j,children:"Randomise Rule"}):Object(E.jsx)("button",{className:"startButton",onClick:function(){return k.apply(this,arguments)},children:"Start"})]})]})]})})}i(85);s.a.render(Object(E.jsx)(M,{}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.be5e04f7.chunk.js.map