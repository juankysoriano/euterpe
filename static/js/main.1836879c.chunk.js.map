{"version":3,"sources":["sketch/SketchProvider.ts","performers/cellularAutomataPainter.ts","performers/cellularAutomataPlayer.ts","sketch/sketch.tsx","resources/images/github.png","cellular-automata/1d/elementaryCellularAutomata1D.ts","cellular-automata/1d/totalisticCellularAutomata1D.ts","cellular-automata/index.ts","human-music/automata-selector.tsx","human-music/human-music.tsx","resources/images/earth.png","index.tsx"],"names":["SketchProvider","React","createContext","colors","CellularAutomata1DPainter","sketch","automata","offset","step","cellSize","this","width","size","i","noFill","stroke","state","lines","window","devicePixelRatio","line","Math","random","height","background","Builder","Error","CellularAutomata1DPlayer","instrument","note","lastNote","voice","lastVoice","notes","voices","chords","chordsDistance","voicesDistance","noteDistance","playNote","playChord","targetIndex","leeDistance","length","actualIndex","midiNote","Tone","transpose","toFrequency","triggerAttackRelease","undefined","states","chord","midiNotes","Chord","get","map","reduce","acc","_","index","euclideanDistance","abs","previousState","min","releaseAll","dispose","a","urls","baseUrl","process","toDestination","automataPainter","automataPlayer","p5","setup","createCanvas","$","frameRate","updateWithProps","props","resizeCanvas","newAutomata","clear","updateSketch","draw","evolve","play","noLoop","stop","floor","withSketch","withAutomata","withOffset","build","loop","CellularAutomataSketch","useReducer","x","ignored","forceUpdate","useEffect","debounced","debounce","handleResize","addEventListener","removeEventListener","Consumer","className","id","customClass","ElementaryCellularAutomata1D","radius","rule","initialState","lookupTable","_state","tempState","neighbourhoodCode","Array","from","forEach","evolveCellAt","stateSave","code","computeCodeFor","lookUpIndex","exponential","pow","wrappedIndex","offsetA","offsetB","randomInitialConfiguration","ruleCharacters","BigInt","toString","character","round","Dimensions","Type","Size","TotalisticCellularAutomata1D","numberOfInvolvedCells","CellularAutomata","dimensions","UNIDIMENSIONAL","type","ELEMENTARY","BIDIMENSIONAL","document","getElementById","sketchWidth","clientWidth","EXTRA_SMALL","SMALL","MEDIUM","LARGE","EXTRA_LARGE","TOTALISTIC","buildTotallistic1D","buildElementary1D","AutomataSelector","ceil","maxRule","withSize","withStates","withType","withDimensions","withRule","leeValues","Set","add","HumanMusic","useState","started","setStarted","setAutomata","ruleSelector","randomiseAutomata","randomAutomata","Provider","value","name","content","src","alt","onClick","href","github","ReactDOM","render"],"mappings":"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","file":"static/js/main.1836879c.chunk.js","sourcesContent":["import React from \"react\";\nimport { CellularAutomata, CellularAutomata1D, Dimensions, Size, Type } from \"../cellular-automata\";\n\nconst SketchProvider = React.createContext(null as unknown as CellularAutomata1D);\n\nexport default SketchProvider;","import p5 from 'p5';\nimport { off } from 'process';\nimport { CellularAutomata1D } from '../cellular-automata';\n\nconst colors = [\n    ['#09090935', '#542c0a35', '#3c201135'],\n    ['#000000', '#ff5789', '#e8b354'],\n    ['#000000', '#49719d', '#e8b354'],\n    ['#000000', '#c23b22', '#e8b354'],\n    ['#000000', '#e8b354', '#49719d'],\n    ['#000000', '#fae2b7', '#d62828']\n];\n\nexport class CellularAutomata1DPainter {\n    private step: number = 0;\n    private cellSize: number;\n    private sketch: p5;\n    private automata: CellularAutomata1D;\n    private offset: number;\n\n    constructor(sketch: p5, automata: CellularAutomata1D, offset: number) {\n        this.sketch = sketch;\n        this.automata = automata;\n        this.cellSize = this.sketch.width / automata.size;\n        this.offset = offset;\n    }\n\n    draw() {\n        for (let i = 0; i < this.automata.size; i++) {\n            this.sketch.noFill();\n            this.sketch.stroke(colors[0][this.automata.state[i]]);\n            for (let lines = 0; lines < 32 / window.devicePixelRatio; lines++) {\n                this.sketch.line(\n                    this.cellSize * i + this.cellSize / 2 + (Math.random() * 2 * this.cellSize - this.cellSize),\n                    this.cellSize * this.step + this.cellSize / 2 + (Math.random() * 2 * this.cellSize - this.cellSize), \n                    this.cellSize * i + this.cellSize / 2 + (Math.random() * 2 * this.cellSize - this.cellSize), \n                    this.cellSize * this.step + this.cellSize / 2 + (Math.random() * 2 * this.cellSize - this.cellSize));\n            }\n        }\n\n        if (this.step * this.cellSize >= this.sketch.height) {\n            this.sketch.background(9, 9, 9, 235);\n            this.step = 0;\n        } else {\n            this.step++;\n        }\n    }\n\n    static Builder = class {\n        private sketch?: p5;\n        private automata?: CellularAutomata1D;\n        private offset = 0;\n\n        withSketch(sketch: p5) {\n            this.sketch = sketch;\n            return this;\n        }\n\n        withAutomata(automata: CellularAutomata1D) {\n            this.automata = automata;\n            return this;\n        }\n\n        withOffset(offset: number) {\n            this.offset = offset;\n            return this;\n        }\n\n        build() {\n            if (this.automata === null) {\n                throw new Error(\"Must pass a cellular automata upon building\");\n            }\n            if (this.sketch === null) {\n                throw new Error(\"Must pass a p5 sketch upon building\");\n            }\n            return new CellularAutomata1DPainter(this.sketch!, this.automata!, this.offset);\n        }\n    }\n}","import * as Tone from 'tone'\nimport { CellularAutomata1D } from \"../cellular-automata\";\nimport { Chord } from \"@tonaljs/tonal\";\n\nconst NOTE_DURATION = 40;\n\nexport class CellularAutomata1DPlayer {\n    private note = \"\";\n    private lastNote = \"\";\n    private voice = \"\";\n    private lastVoice = \"\";\n    private notes = [\n        \"C4\", \"D4\",\n        \"C4\", \"D4\", \"E4\",\n        \"C4\", \"D4\", \"E4\", \"F4\",\n        \"C4\", \"D4\", \"E4\", \"F4\", \"G4\",\n        \"C4\", \"D4\", \"E4\", \"F4\", \"G4\", \"A4\", \"B4\"\n    ]\n    private voices = [\n        \"C5\", \"D5\",\n        \"C5\", \"D5\", \"E5\", \"F5\",\n        \"C5\", \"D5\", \"E5\", \"F5\", \"G5\", \"A5\", \"B5\"\n    ]\n    private chords = [\n        \"C2major\", \"C2maj7\",\n        \"D2m\", \"D2m7\",\n        \"E2m\", \"E2m7\",\n        \"F2maj7\",\n        \"A2m\", \"A2m7\",\n        \"B2m7b5\",\n        \"C3major\", \"C3maj7\",\n        \"D3m\", \"D3m7\",\n        \"E3m\", \"E3m7\",\n        \"F3maj7\",\n        \"A3m\", \"A3m7\",\n        \"B3m7b5\"\n    ];\n    private instrument: Tone.Sampler;\n    private automata: CellularAutomata1D;\n    private offset = 0;\n    private chordsDistance = 8;\n    private voicesDistance = 4;\n    private noteDistance = 1;\n    private step = 0;\n\n    constructor(instrument: Tone.Sampler, automata: CellularAutomata1D, offset: number) {\n        this.instrument = instrument;\n        this.automata = automata;\n        this.offset = offset;\n    }\n\n    play() {\n        this.playNote();\n        //this.playVoice();\n        this.playChord();\n\n        this.step++;\n    }\n\n    private playNote() {\n        let targetIndex = this.leeDistance(1) % (this.notes.length * 2);\n        let actualIndex = targetIndex >= this.notes.length ? this.notes.length - (targetIndex % this.notes.length) - 1 : targetIndex;\n        this.note = this.notes[actualIndex % this.notes.length];\n\n        if (this.step % this.noteDistance == 0 && this.note != this.lastNote) {\n            let midiNote = Tone.Frequency(this.note).transpose(this.offset).toFrequency();\n            this.instrument.triggerAttackRelease(midiNote, NOTE_DURATION, undefined, 0.15);\n        }\n\n        this.lastNote = this.note;\n    }\n\n    private playVoice() {\n        let targetIndex = this.leeDistance(2) % (this.voices.length * 2);\n        let actualIndex = targetIndex >= this.voices.length ? this.voices.length - (targetIndex % this.voices.length) - 1 : targetIndex;\n        this.voice = this.voices[actualIndex % this.voices.length];\n\n        if (this.step % this.voicesDistance == 0 && this.automata.states == 3 && this.voice != this.lastVoice) {\n            let midiNote = Tone.Frequency(this.voice).transpose(this.offset).toFrequency();\n            this.instrument.triggerAttackRelease(midiNote, NOTE_DURATION, undefined, 0.2);\n        }\n\n        this.lastVoice = this.voice;\n    }\n\n    private playChord() {\n        let targetIndex = this.leeDistance(0) % (this.chords.length * 2);\n        let actualIndex = targetIndex >= this.chords.length ? this.chords.length - (targetIndex % this.chords.length) - 1 : targetIndex;\n        let chord = this.chords[actualIndex % this.chords.length];\n        if (this.step % this.chordsDistance == 0) {\n            let midiNotes = Chord.get(chord).notes.map((note) => Tone.Frequency(note).transpose(this.offset).toFrequency())\n            this.instrument.triggerAttackRelease(midiNotes, NOTE_DURATION, undefined, 0.1);\n        }\n    }\n\n    private leeDistance(state: number) {\n        return this.automata.state.reduce((acc, _, index) => {\n            let euclideanDistance = Math.abs(this.automata.state[index] - this.automata.previousState[index])\n            let leeDistance = Math.min(euclideanDistance, this.automata.states - euclideanDistance)\n            return this.automata.state[index] != state ? acc : acc + leeDistance;\n        }, 0);\n    }\n\n    stop() {\n        this.instrument.releaseAll();\n        this.instrument.dispose();\n        this.note = \"\";\n        this.lastNote = \"\";\n        this.step = 0;\n    }\n\n    static Builder = class {\n        private automata?: CellularAutomata1D\n        private offset = 0;\n\n        withAutomata(automata: CellularAutomata1D) {\n            this.automata = automata;\n            return this;\n        }\n\n        withOffset(offset: number) {\n            this.offset = offset;\n            return this;\n        }\n\n        async build() {\n            if (this.automata === null) {\n                throw new Error(\"Must pass a cellular automata upon building\");\n            }\n            const instrument = new Tone.Sampler({\n                urls: {\n                    \"C4\": \"fart-c.mp3\",\n                    \"D4\": \"fart-d.mp3\",\n                    \"E4\": \"fart-e.mp3\",\n                    \"F4\": \"fart-f.mp3\",\n                    \"G4\": \"caca.mp3\",\n                    \"A4\": \"fart-a.mp3\",\n                    \"B4\": \"pedo.mp3\"\n                },\n                baseUrl: process.env.PUBLIC_URL + \"/sounds/\",\n            }).toDestination();\n\n            await Tone.loaded();\n\n            return new CellularAutomata1DPlayer(instrument, this.automata!, this.offset);\n        }\n    }\n}","import { P5Instance, ReactP5Wrapper, Sketch } from \"react-p5-wrapper\";\nimport SketchProvider from './SketchProvider';\nimport { CellularAutomata, CellularAutomata1D, Dimensions, Size, Type } from '../cellular-automata';\nimport { CellularAutomata1DPainter } from \"../performers/cellularAutomataPainter\";\nimport { CellularAutomata1DPlayer } from \"../performers/cellularAutomataPlayer\";\nimport $ from 'jquery';\nimport React, { useReducer } from \"react\";\nimport { debounce } from \"ts-debounce\";\n\nlet automata: CellularAutomata1D;\nlet automataPainter: CellularAutomata1DPainter;\nlet automataPlayer: CellularAutomata1DPlayer;\n\nconst sketch: Sketch = p5 => {\n  p5.setup = () => {\n    p5.createCanvas($('#sketch').width()!, $('#sketch').height()!);\n    p5.background(9, 9, 9);\n    p5.frameRate(2.5);\n  };\n\n  p5.updateWithProps = props => {\n    p5.resizeCanvas($('#sketch').width()!, $('#sketch').height()!);\n    if (props.newAutomata) {\n      p5.clear();\n      p5.background(9, 9, 9);\n      updateSketch(p5, props.newAutomata);\n    }\n  }\n\n  p5.draw = () => {\n    automataPainter?.draw();\n    automata?.evolve();\n    automataPlayer?.play();\n  }\n}\n\nasync function updateSketch(p5: P5Instance, newAutomata: CellularAutomata1D) {\n  p5.noLoop();\n  automataPlayer?.stop();\n  automata = null as any;\n  automataPainter = null as any;\n  automataPlayer = null as any;\n\n  automata = newAutomata;\n\n  let offset = Math.floor(Math.random() * 6);\n\n  automataPainter = new CellularAutomata1DPainter.Builder()\n    .withSketch(p5)\n    .withAutomata(newAutomata)\n    .withOffset(offset)\n    .build();\n\n  automataPlayer = await new CellularAutomata1DPlayer.Builder()\n    .withAutomata(automata)\n    .withOffset(offset)\n    .build();\n\n  p5.loop();\n}\n\nexport default function CellularAutomataSketch() {\n  const [ignored, forceUpdate] = useReducer(x => x + 1, 0);\n\n  React.useEffect(() => {\n    const debounced = debounce(() => { forceUpdate(); }, 200);\n    const handleResize = function () { debounced(); }\n    window.addEventListener('resize', handleResize);\n\n    return (() => window.removeEventListener('resize', handleResize))\n  }, [])\n\n  return (<SketchProvider.Consumer>\n    {newAutomata => (\n      <div className=\"CellularAutomataSketch\" id=\"sketch\">\n        <ReactP5Wrapper customClass=\"canvas\"\n          sketch={sketch}\n          newAutomata={newAutomata}\n          ignored={ignored} />\n      </div>\n    )}\n  </SketchProvider.Consumer>);\n}\n\n","export default __webpack_public_path__ + \"static/media/github.41bf9875.png\";","import { CellularAutomata1D } from './cellularAutomata1D';\n\nexport class ElementaryCellularAutomata1D implements CellularAutomata1D {\n    readonly states: number;\n    readonly size: number;\n    readonly radius: number;\n    readonly rule: number;\n    private _state: number[];\n    private tempState: number[];\n    private neighbourhoodCode: number[];\n    private lookupTable: number[];\n\n    constructor(states: number, size: number, radius: number, rule: number, initialState: number[], lookupTable: number[]) {\n        this.states = states;\n        this.size = size;\n        this.radius = radius;\n        this.rule = rule;\n        this._state = initialState;\n        this.lookupTable = lookupTable;\n        this.tempState = Array.from({ length: size });\n        this.neighbourhoodCode = Array.from({ length: size });\n    }\n\n    get state(): readonly number[] {\n        return this._state;\n    }\n\n    get previousState(): readonly number[] {\n        return this.tempState;\n    }\n\n    evolve() {\n        this.state.forEach((_, index) => { this.evolveCellAt(index); });\n        const stateSave = this.tempState;\n        this.tempState = this._state;\n        this._state = stateSave;\n    }\n\n    private evolveCellAt(index: number) {\n        const code = this.lookupTable.length - this.computeCodeFor(index) - 1;\n        this.tempState[index] = code >= 0 ? this.lookupTable[code] : 0;\n    }\n\n    private computeCodeFor(index: number) {\n        let exponential = Math.pow(this.states, 2 * this.radius)\n        let lookUpIndex: number;\n        let code = 0;\n        if (index === 0) {\n            for (let i = -this.radius; i <= this.radius; i++) {\n                lookUpIndex = this.wrappedIndex(i);\n                code += exponential * this._state[lookUpIndex];\n                exponential /= this.states;\n            }\n        } else {\n            lookUpIndex = this.wrappedIndex(index - this.radius - 1);\n            let offsetA = exponential * this._state[lookUpIndex];\n            lookUpIndex = this.wrappedIndex(index + this.radius);\n            let offsetB = this._state[lookUpIndex];\n            code = (this.neighbourhoodCode[index - 1] - offsetA) * this.states + offsetB;\n        }\n        this.neighbourhoodCode[index] = code;\n        return code;\n    }\n\n    private wrappedIndex(index: number) {\n        return index < 0 ? index + this.size : index >= this.size ? index - this.size : index;\n    }\n\n\n    static Builder = class {\n        private states: number = 2;\n        private size: number = 100;\n        private rule: number = 0;\n        private randomInitialConfiguration: boolean = false;\n\n        withStates(states: number) {\n            if (states < 1) {\n                throw new Error(\"Number of states must be greater than 1\");\n            }\n            this.states = states;\n            return this;\n        }\n\n        withSize(size: number) {\n            this.size = size;\n            if (size <= 10) {\n                throw new Error(\"Size of cellular automata must be greater than 10\");\n            }\n            return this;\n        }\n\n        withRule(rule: number) {\n            this.rule = rule;\n            if (rule < 0) {\n                throw new Error(\"Rule must be a positive number\");\n            }\n            return this;\n        }\n\n        withRandomInitialConfiguration() {\n            this.randomInitialConfiguration = true;\n            return this;\n        }\n\n        build() {\n            const radius = 1;\n            const ruleCharacters = Array.from(BigInt(this.rule).toString(this.states));\n            const lookupTable: number[] = Array.from({ length: ruleCharacters.length });\n            for (let i = 0; i < ruleCharacters.length; i++) {\n                let character = ruleCharacters[i];\n                if (character >= '0' && character <= '9') {\n                    lookupTable[i] = +ruleCharacters[i] - +'0';\n                } else {\n                    lookupTable[i] = +ruleCharacters[i] - +'W'\n                }\n            }\n            const initialState = this.randomInitialConfiguration\n                ? Array.from({ length: this.size }, () => Math.round(Math.random()))\n                : Array.from({ length: this.size }, (_, index) => index === Math.floor(this.size / 2) ? 1 : 0);\n\n            return new ElementaryCellularAutomata1D(\n                this.states,\n                this.size,\n                radius,\n                this.rule,  \n                initialState,\n                lookupTable\n            );\n        }\n    }\n}","import { CellularAutomata1D } from \"./cellularAutomata1D\";\n\nexport class TotalisticCellularAutomata1D implements CellularAutomata1D {\n    readonly states: number;\n    readonly size: number;\n    readonly radius: number;\n    readonly rule: number;\n    private _state: number[];\n    private tempState: number[];\n    private neighbourhoodCode: number[];\n    private lookupTable: number[];\n\n    constructor(states: number, size: number, radius: number, rule: number, initialState: number[], lookupTable: number[]) {\n        this.states = states;\n        this.size = size;\n        this.radius = radius;\n        this.rule = rule;\n        this._state = initialState;\n        this.lookupTable = lookupTable;\n        this.tempState = Array.from({ length: size });\n        this.neighbourhoodCode = Array.from({ length: size });\n    }\n\n    get state(): ReadonlyArray<number> {\n        return this._state;\n    }\n\n    get previousState(): readonly number[] {\n        return this.tempState;\n    }\n\n    evolve() {\n        this.state.forEach((_, index) => {\n            this.evolveCellAt(index);\n        });\n        const stateSave = this.tempState;\n        this.tempState = this._state;\n        this._state = stateSave;\n    }\n\n    private evolveCellAt(index: number) {\n        const code = this.lookupTable.length - this.computeCodeFor(index) - 1;\n        this.tempState[index] = code >= 0 ? this.lookupTable[code] : 0;\n    }\n\n    private computeCodeFor(index: number) {\n        let lookUpIndex: number;\n        let numberOfInvolvedCells = 2 * this.radius + 1;\n        let code = 0;\n        if (index === 0) {\n            for (let i = -this.radius; i < numberOfInvolvedCells; i++) {\n                lookUpIndex = this.wrappedIndex(i);\n                code += this._state[lookUpIndex];\n            }\n        } else {\n            lookUpIndex = this.wrappedIndex(index - this.radius - 1);\n            let offsetA = this._state[lookUpIndex];\n            lookUpIndex = this.wrappedIndex(index + this.radius);\n            let offsetB = this._state[lookUpIndex];\n            code = this.neighbourhoodCode[index - 1] - offsetA + offsetB;\n        }\n        this.neighbourhoodCode[index] = code;\n        return code;\n    }\n\n    private wrappedIndex(index: number) {\n        return index < 0 ? index + this.size : index >= this.size ? index - this.size : index;\n    }\n}","import { ElementaryCellularAutomata1D } from './1d/elementaryCellularAutomata1D';\nimport { TotalisticCellularAutomata1D } from './1d/totalisticCellularAutomata1D';\n\nexport interface CellularAutomata1D {\n    readonly radius: any;\n    readonly size: number;\n    readonly rule: number;\n    readonly states: number;\n    get state(): ReadonlyArray<number>;\n    get previousState(): ReadonlyArray<number>;\n    evolve(): void;\n};\n\nexport enum Dimensions {\n    UNIDIMENSIONAL,\n    BIDIMENSIONAL\n}\n\nexport enum Type {\n    TOTALISTIC,\n    ELEMENTARY\n}\n\nexport enum Size {\n    EXTRA_SMALL,\n    SMALL,\n    MEDIUM,\n    LARGE,\n    EXTRA_LARGE\n}\n\nexport class CellularAutomata {\n    static Builder = class {\n        private dimensions: Dimensions = Dimensions.UNIDIMENSIONAL;\n        private type: Type = Type.ELEMENTARY;\n        private states: number = 2;\n        private size: number = 100;\n        private rule: number = 0;\n        private randomInitialConfiguration: boolean = false;\n\n        withDimensions(dimensions: Dimensions) {\n            if (dimensions === Dimensions.BIDIMENSIONAL) {\n                throw new Error(\"Bi-dimensional automata not implemented yet\");\n            }\n            this.dimensions = dimensions;\n            return this;\n        }\n\n        withType(type: Type) {\n            this.type = type;\n            return this;\n        }\n\n        withStates(states: number) {\n            if (states < 1) {\n                throw new Error(\"Number of states must be greater than 1\");\n            }\n            this.states = states;\n            return this;\n        }\n\n        withSize(size: Size) {\n            const sketch = document.getElementById('sketch');\n            const sketchWidth = sketch === null ? 0 : sketch.clientWidth;\n\n            switch (size) {\n                case Size.EXTRA_SMALL: this.size = sketchWidth / 30; break;\n                case Size.SMALL: this.size = sketchWidth / 15; break;\n                case Size.MEDIUM: this.size = sketchWidth / 5; break;\n                case Size.LARGE: this.size = sketchWidth / 2; break;\n                case Size.EXTRA_LARGE: this.size = sketchWidth / 1; break;\n            };\n            this.size = 151;\n            return this;\n        }\n\n        withRule(rule: number) {\n            this.rule = rule;\n            if (rule < 0) {\n                throw new Error(\"Rule must be a positive number\");\n            }\n            return this;\n        }\n\n        withRandomInitialConfiguration() {\n            this.randomInitialConfiguration = true;\n            return this;\n        }\n\n        build() {\n            return this.type === Type.TOTALISTIC ? this.buildTotallistic1D() : this.buildElementary1D();\n        }\n\n        private buildTotallistic1D() {\n            const radius = 1;\n            const ruleCharacters = Array.from(BigInt(this.rule).toString(this.states));\n            const lookupTable: number[] = Array.from({ length: ruleCharacters.length });\n            for (let i = 0; i < ruleCharacters.length; i++) {\n                lookupTable[i] = +ruleCharacters[i] - +'0';\n            }\n            const initialState = this.randomInitialConfiguration\n                ? Array.from({ length: this.size }, () => Math.round(Math.random()))\n                : Array.from({ length: this.size }, (_, index) => index === Math.floor(this.size / 2) ? 1 : 0);\n\n            return new TotalisticCellularAutomata1D(\n                this.states,\n                this.size,\n                radius,\n                this.rule,\n                initialState,\n                lookupTable\n            );\n        }\n\n        private buildElementary1D() {\n            const radius = 1;\n            const ruleCharacters = Array.from(BigInt(this.rule).toString(this.states));\n            const lookupTable: number[] = Array.from({ length: ruleCharacters.length });\n\n            for (let i = 0; i < ruleCharacters.length; i++) {\n                let character = ruleCharacters[i];\n                if (character >= '0' && character <= '9') {\n                    lookupTable[i] = +ruleCharacters[i] - +'0';\n                } else {\n                    lookupTable[i] = +ruleCharacters[i] - +'W'\n                }\n            }\n            const initialState = this.randomInitialConfiguration\n                ? Array.from({ length: this.size }, () => Math.round(Math.random()))\n                : Array.from({ length: this.size }, (_, index) => index === Math.floor(this.size / 2) ? 1 : 0);\n            \n            return new ElementaryCellularAutomata1D(\n                this.states,\n                this.size,\n                radius,\n                this.rule,\n                initialState,\n                lookupTable\n            );\n        }\n    }\n}\n\nexport * from './1d/totalisticCellularAutomata1D';\nexport * from './1d/elementaryCellularAutomata1D'\n","import { CellularAutomata, Dimensions, Size, Type } from \"../cellular-automata\";\nimport { CellularAutomata1D } from \"../cellular-automata/1d/cellularAutomata1D\";\n\nexport class AutomataSelector {\n    randomAutomata() {\n        let radius = 1;\n        let type = Math.random() < 0.5 ? Type.ELEMENTARY : Type.TOTALISTIC;\n        let states = 1 + Math.ceil(Math.random() * 2);\n        let maxRule = 0;\n        switch (type) {\n            case Type.ELEMENTARY:\n                maxRule = Math.pow(states, Math.pow(states, (2 * radius + 1))) - 1;\n                break;\n            case Type.TOTALISTIC:\n                maxRule = Math.pow(states, (states * (2 * radius + 1))) - 1;\n                break;\n        }\n\n        while (true) {\n            let rule = Math.round(Math.random() * maxRule);\n            let automata = new CellularAutomata.Builder()\n                .withSize(Size.LARGE)\n                .withStates(states)\n                .withType(type)\n                .withDimensions(Dimensions.UNIDIMENSIONAL)\n                .withRule(rule)\n                .build();\n\n            let leeValues = new Set();\n\n            for (let step = 0; step < 100; step++) {\n                leeValues.add(this.leeDistance(automata));\n                automata.evolve();\n            }\n\n            if (leeValues.size >= 15) {\n                return new CellularAutomata.Builder()\n                .withSize(Size.LARGE)\n                .withStates(states)\n                .withType(type)\n                .withDimensions(Dimensions.UNIDIMENSIONAL)\n                .withRule(rule)\n                .build();\n            }\n        }\n    }\n\n    private leeDistance(automata: CellularAutomata1D) {\n        return automata.state.reduce((acc, _, index) => {\n            let euclideanDistance = Math.abs(automata.state[index] - automata.previousState[index])\n            let leeDistance = Math.min(euclideanDistance, automata.states - euclideanDistance)\n            return automata.state[index] == 0 ? acc : acc + leeDistance;\n        }, 0);\n    }\n}","import { useState } from \"react\";\nimport SketchProvider from \"../sketch/SketchProvider\";\nimport CellularAutomataSketch from \"../sketch/sketch\";\nimport './styles/HumanMusicStyle.css'\nimport * as Tone from 'tone'\nimport earth from '../resources/images/earth.png'\nimport github from '../resources/images/github.png'\nimport { AutomataSelector } from \"./automata-selector\";\nimport { CellularAutomata1D } from \"../cellular-automata\";\n\nexport default function HumanMusic() {\n    const [started, setStarted] = useState(false);\n    const [automata, setAutomata] = useState(null as unknown as CellularAutomata1D);\n\n    let ruleSelector = new AutomataSelector();\n\n    async function start() {\n        await Tone.start();\n        setStarted(true);\n        randomiseAutomata();\n    }\n\n    async function randomiseAutomata() {\n        const automata = ruleSelector.randomAutomata();\n        setAutomata(automata);\n    }\n\n    return <SketchProvider.Provider value={automata}>\n        <meta name=\"viewport\" content=\"width=device-width, height=device-height, initial-scale=1.0, viewport-fit=cover\"/> \n        <body className=\"HumanMusic\">\n            <div className=\"Headers\">\n                <img src={earth} className=\"EarthRadioLogo\" alt=\"Earth\" />\n                <h1 className=\"Title\">Los Pedos</h1>\n                <h2 className=\"Subtitle\">de Bruno</h2>\n            </div>\n            <div className=\"Automata\">\n                <div className=\"flip-card\">\n                    <div className=\"flip-card-inner\">\n                        <div className=\"flip-card-front\">\n                            <CellularAutomataSketch />\n                        </div>\n                        <div className=\"flip-card-back\">\n                            <p className=\"PlayingRule\">{started ? \"Playing rule: \" + automata?.rule : \"--\"}</p>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"Controllers\">\n                    {started\n                        ? <button className=\"ruleButton\" onClick={randomiseAutomata}>Randomise</button>\n                        : <button className=\"startButton\" onClick={start}>Start</button>\n                    }\n                </div>\n            </div>\n            <div className=\"Misc\">\n                <a className=\"GitHubLink\" href=\"https://github.com/juankysoriano/human-music\">\n                    <img className=\"GitHubLogo\" alt=\"GitHub\" src={github}></img>\n                </a>\n                <p className=\"Dad\">A mi padre ♥</p>\n            </div>\n        </body>\n    </SketchProvider.Provider>\n}","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKoAAACgCAYAAACc7ffkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADWUlEQVR4nO3dMYtUZxiG4ZkgFiGQxSplSrvF9JY26UVIof/AytofkSZptRBCehEsrdIk2KUMpEklKxoDNqZIG8k77JmcuWeuq/6YM+zefM3D2d1u1vNhxWdPbFd6rp/Lv/hkjYfCroRKglBJECoJQiVBqCQIlQShkiBUEvaxMoyWlQ+//LiHRy9ne+P2+OjwnJ/LJbhRSRAqCUIlQagkCJUEoZIgVBKESoJQSdhlPTiKZWXq9dt3o3NnN++Nzl28eDQ69/lnn47OHbqlFyw3KglCJUGoJAiVBKGSIFQShEqCUEkQKgnbzYktTlPTZWppx7JMLb3suVFJECoJQiVBqCQIlQShkiBUEoRKglBJuLL2F6j79snT0bn733y952/y/5guTm/+/GvR57pRSRAqCUIlQagkCJUEoZIgVBKESoJQSbBMfcT03aWH3/0wOncsy9Ra3KgkCJUEoZIgVBKESoJQSRAqCUIlQagkWKY+Yvpu0OP357MP/OkSX+YSlv6rhNN3oV69frvoc92oJAiVBKGSIFQShEqCUEkQKglCJUGoJFzZ/PO/pv7T9sbto/h/VGv9/6iptb7f0ovT+Z0H00eP+nOjkiBUEoRKglBJECoJQiVBqCQIlQShkjBaBXY0WrAuXjzaw6OXc3bz3ujc9J2pu1dfjs79/uz70bmlrbU4TblRSRAqCUIlQagkCJUEoZIgVBKESoJQSdjHMjU1WrDWMv4rfQubLlgrWqUZNyoJQiVBqCQIlQShkiBUEoRKglBJECoJay5Tq3j8/ny0iF3bXB993s/P/xid++rWF6Nzrza/js7dvfrypH53blQShEqCUEkQKglCJUGoJAiVBKGSIFQSjmbdmC5Ovz0/G33edEmami5O00Xs1BYsNyoJQiVBqCQIlQShkiBUEoRKglBJECoJB79aTBentUyXri9vXYzOLb1MTR36guVGJUGoJAiVBKGSIFQShEqCUEkQKglCJeGg14hdLP1X+pZ+x2lp3pmCAyRUEoRKglBJECoJQiVBqCQIlQShknAUq8Uu1lqwln636lgWpyk3KglCJUGoJAiVBKGSIFQShEqCUEkQKgkntW7sYrpgTReipT/v1LhRSRAqCUIlQagkCJUEoZIgVBKESoJQSfgbOcaPStU5NGkAAAAASUVORK5CYII=\"","import ReactDOM from 'react-dom';\nimport HumanMusic from './human-music/human-music';\nimport './styles/index.css';\n\nReactDOM.render(\n  <HumanMusic/>,\n  document.getElementById('root')\n);"],"sourceRoot":""}